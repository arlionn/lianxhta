
**Note-助教须知**：&#x1F34E; 

- 下文是由 AI 生成的初稿，你可以在此基础上修改、润色，也可以大幅修改。
  - AI 无法插入图片、表格等。这些内容需要你从论文原文中截图插入，有些图片需要执行代码后插入。
  - AI 无法直接运行代码，因此初稿中的代码需要你自行运行，并将结果采用代码块的形式插入推文中。你可以借助 AI 补充一些针对代码和运行结果的解释文字。
  - AI 生成的初稿中，可能会遗漏一些重要的细节和内容，请务必对照论文原文进行补充和完善，确保推文内容的完整性和准确性。
  - AI 的表述难免存在「机器味」，因此，你需要对推文进行润色和修改，使其更符合人类读者的阅读习惯和理解方式。


----

# 中文精要：Goldsmith-Pinkham-2024-arXiv

> **作者：** xx (xxx)    
> **邮箱：** <xxx@xxx.com> 

> **Source**：本文参考了如下资料，特此致谢！  Goldsmith-Pinkham, P., Hull, P., & Kolesár, M. (2024). Contamination Bias in Linear Regressions (Version 3). arXiv. [Link](https://doi.org/10.48550/arXiv.2106.05024) (rep), [PDF](https://arxiv.org/pdf/2106.05024.pdf), [Google](<https://scholar.google.com/scholar?q=Contamination Bias in Linear Regressions>), [GitHub](https://github.com/gphk-metrics/stata-multe).

&emsp; 

- **Title**: multe——OLS 回归中的污染偏差诊断命令
- **Keywords**: 污染偏差, 倾向得分, 多重处理, OLS, ATE, multe, 因果推断, 计量经济学

&emsp; 

>**声明**：本文写作过程中借助了 AI 工具，但内容经过了严格的审核和润色，确保准确传达了原论文的核心思想和方法。  
- [Claude 对话链接](https://claude.ai/share/f740a456-5068-4dab-bcd5-65b9ce85a75d)
- [ChatGPT 对话链接]()

---

## 1. 简介

在实证研究中，我们经常需要估计某种处理 (treatment) 对结果变量的因果效应。当处理变量包含多个类别时 (例如不同种族、不同教育水平、不同政策干预强度等)，研究者通常会采用多元线性回归 (OLS) 来估计各个处理组相对于对照组的平均处理效应。然而，Goldsmith-Pinkham, Hull, and Kolesár (2024) 指出，当控制变量与处理变量的倾向得分 (propensity score) 存在关联时，标准的 OLS 估计会产生**污染偏差** (contamination bias)，导致我们无法准确识别感兴趣的因果效应。

污染偏差的核心问题在于：当我们在回归中加入控制变量时，这些控制变量不仅会影响被解释变量，还会通过改变不同处理组的**有效样本权重**来「污染」处理效应的估计。具体而言，OLS 估计量实际上是各个处理组**自身处理效应** (own treatment effect) 和其他处理组**污染效应** (contamination effect) 的加权平均。当倾向得分在样本中存在显著变异时，这种污染效应可能会很大，从而使得 OLS 估计严重偏离我们关心的平均处理效应 (ATE)。

为了帮助研究者诊断和纠正这一问题，Goldsmith-Pinkham 等人开发了 Stata 命令 `multe`，该命令基于他们的理论框架，提供了一整套污染偏差的诊断工具和替代估计方法。`multe` 命令不仅能够计算标准的部分线性模型 (PL) 估计量，还能提供以下四种不受污染偏差影响的替代估计量：

- **OWN**：仅保留自身处理效应部分，剔除污染偏差的估计量
- **ATE**：未加权的平均处理效应估计量
- **EW**：基于「最易估计加权」(easiest-to-estimate weighting) 方案的加权 ATE 估计量
- **CW**：基于「最易估计公共加权」(easiest-to-estimate common weighting) 方案的加权 ATE 估计量

此外，`multe` 还提供了两个关键的统计检验 (Wald 检验和 LM 检验)，用于检测倾向得分是否在样本中存在显著变异——这是污染偏差产生的前提条件。如果这些检验的 p 值很小，说明污染偏差可能很严重，研究者应当谨慎解读标准 OLS 结果，并考虑使用替代估计量。

**关键 Stata 命令**：

- 污染偏差诊断：`multe`
- 后估计命令：`multe, est()` (指定估计量类型)、`multe, diff` (计算估计量差异)、`multe, oracle` (计算 oracle 标准误)、`multe, overlap` (重点关注重叠样本)

本文将详细介绍污染偏差的理论基础、`multe` 命令的使用方法，并通过 Fryer and Levitt (2013) 关于种族与儿童认知能力的经典研究数据，展示如何在实证研究中诊断和处理污染偏差问题。

---

## 2. 污染偏差的理论基础

### 2.1 多重处理与部分线性模型

考虑一个标准的部分线性模型 (partly linear model)，其中我们关心多个处理变量 $D_1, D_2, \ldots, D_K$ 对结果变量 $Y$ 的因果效应，同时需要控制一组协变量 $X$：

$$Y_i = \sum_{k=1}^{K} \beta_k D_{ik} + g(X_i) + \varepsilon_i$$

其中，$g(X)$ 是协变量的某种函数形式 (可以是线性的，也可以是非参数的)，$\varepsilon$ 是不可观测的随机扰动项。我们的目标是估计处理效应 $\beta_k$，它衡量的是第 $k$ 个处理组相对于对照组 (基准组) 的平均因果效应。

在实践中，研究者通常采用 OLS 回归来估计这个模型，即：

$$Y_i = \sum_{k=1}^{K} \beta_k D_{ik} + X_i'\gamma + \varepsilon_i$$

其中，$X$ 包含所有控制变量。然而，这种看似简单的 OLS 估计实际上隐含了一个重要假设：**控制变量 $X$ 与处理变量 $D$ 之间不存在系统性的关联**——或者更严格地说，倾向得分 (即给定 $X$ 时接受各种处理的条件概率) 在样本中是**常数**。

### 2.2 倾向得分变异与污染偏差

倾向得分 $e_k(X) = P(D_k = 1 \mid X)$ 刻画了在给定协变量 $X$ 的条件下，个体被分配到第 $k$ 个处理组的概率。在观察性数据中，倾向得分通常会随 $X$ 的取值而变化。例如，在教育回报研究中，家庭收入较高的个体更有可能接受高等教育；在医疗干预研究中，健康状况较差的患者更有可能接受某种治疗。

Goldsmith-Pinkham 等人证明，当倾向得分存在变异时，标准的 OLS 估计量 $\hat{\beta}_k^{PL}$ 可以分解为：

$$\hat{\beta}_k^{PL} = \beta_k^{own} + \sum_{j \neq k} \beta_j^{cont}$$

其中：

- $\beta_k^{own}$ 是第 $k$ 个处理组的**自身处理效应** (own treatment effect)，这是我们真正关心的因果效应
- $\beta_j^{cont}$ 是其他处理组 $j$ 对第 $k$ 组估计的**污染效应** (contamination effect)

污染效应的产生机制可以这样理解：当我们在回归中加入控制变量 $X$ 时，OLS 会自动对不同观测值赋予不同的权重。如果某个处理组的倾向得分与 $X$ 高度相关，那么该组的观测值在回归中会获得更大的权重，从而「挤占」其他处理组的估计空间。这种权重的不均衡分配会导致我们对第 $k$ 组处理效应的估计受到其他组处理效应的「污染」。

污染偏差的严重程度取决于两个因素：

1. **倾向得分的变异程度**：倾向得分在样本中的变化越大，不同处理组之间的权重差异就越大，污染效应也就越严重
2. **处理效应的异质性**：如果不同处理组的真实因果效应差异很大，那么污染效应带来的偏差也会更显著

### 2.3 替代估计策略

为了克服污染偏差，Goldsmith-Pinkham 等人提出了几种替代估计策略，它们的核心思想是通过不同的加权方案或估计方法，消除或减轻污染效应的影响。

**A. 自身处理效应估计量 (OWN)**

OWN 估计量通过从 PL 估计量中减去一个污染偏差的估计值来获得：

$$\hat{\beta}_k^{OWN} = \hat{\beta}_k^{PL} - \widehat{CB}_k$$

其中，$\widehat{CB}_k$ 是通过辅助回归估计得到的污染偏差。这个估计量的优点是计算简单，且在样本量较大时具有良好的渐近性质。

**B. 平均处理效应估计量 (ATE)**

ATE 估计量的目标是估计未加权的平均处理效应，即：

$$\beta_k^{ATE} = E[Y_i(k) - Y_i(0)]$$

其中，$Y_i(k)$ 和 $Y_i(0)$ 分别表示个体 $i$ 在接受处理 $k$ 和不接受处理时的潜在结果。在实践中，ATE 可以通过在回归中加入协变量与处理变量的交互项来估计：

$$Y_i = \sum_{k=1}^{K} \beta_k D_{ik} + \sum_{k=1}^{K} D_{ik} \cdot X_i'\gamma_k + \varepsilon_i$$

这种方法允许每个处理组有不同的 $X$ 系数，从而避免了 PL 模型中的共同斜率假设。

**C. 加权 ATE 估计量 (EW 和 CW)**

EW 和 CW 估计量是 ATE 的加权版本，它们分别采用「最易估计加权」和「最易估计公共加权」方案。这两种加权方案的设计目标是最小化估计的方差，同时保持估计的无偏性。

- **EW**：对每个处理组 $k$，分别运行一个回归，估计该组相对于对照组的处理效应，然后对所有处理组的估计进行加权平均
- **CW**：使用一个公共的权重函数对所有观测值进行加权，然后在加权样本上运行标准回归

这两种方法在倾向得分存在极端值时特别有用，因为它们会自动降低那些倾向得分接近 0 或 1 的观测值的权重，从而提高估计的稳定性。

---

## 3. `multe` 命令的语法与选项

### 3.1 基本语法

```stata
multe depvar [controls] [weight], treat(varname) [stratum(varname) options]
```

**必需参数**：

- `depvar`：因变量 (被解释变量)
- `treat(varname)`：处理变量，必须是分类变量 (factor variable)
- `controls` 或 `stratum`：至少需要指定其中之一
  - `controls`：回归中的控制变量列表
  - `stratum(varname)`：分层变量，用于定义倾向得分估计的层次结构

**可选参数**：

- `weight`：样本权重 (支持 `aweight` 和 `pweight`)
- `cluster(varname)`：聚类标准误
- `est(string)`：指定要展示的估计量类型，可选值为 `PL`、`OWN`、`ATE`、`EW`、`CW`
- `diff`：展示各估计量与 PL 估计量的差异及其标准误
- `overlap`：重点关注「重叠样本」(overlap sample) 的结果
- `oracle`：对 ATE、EW、CW 估计量计算 oracle 标准误 (不考虑倾向得分估计的不确定性)

### 3.2 后估计命令

运行 `multe` 后，可以通过以下后估计命令查看不同的结果：

```stata
* 展示特定估计量的结果
multe, est(ATE)
multe, est(OWN)

* 展示估计量差异
multe, est(OWN) diff

* 展示重叠样本的结果
multe, est(ATE) overlap

* 计算 oracle 标准误
multe, est(ATE) oracle
```

### 3.3 返回结果

`multe` 命令在 `e()` 中存储了大量有用的结果，包括：

- `e(diffmatrix)`：各估计量与 PL 估计量在全样本上的差异矩阵
- `e(overlapdiffmatrix)`：各估计量与 PL 估计量在重叠样本上的差异矩阵
- `e(wald_p)`：倾向得分变异性的 Wald 检验 p 值
- `e(lm_p)`：倾向得分变异性的 LM 检验 p 值

这些结果可以用于进一步的诊断和报告。

---

## 4. 实证应用：种族与儿童认知能力

### 4.1 研究背景

我们使用 Fryer and Levitt (2013) 的数据来演示 `multe` 命令的使用。该研究探讨了种族对儿童早期认知能力的影响，使用的是美国的 Early Childhood Longitudinal Study-Birth Cohort (ECLS-B) 数据。研究者关心的核心问题是：在控制了家庭社会经济地位、儿童年龄、性别等因素后，不同种族 (黑人、西班牙裔、亚裔、其他) 的儿童相对于白人儿童的认知测试成绩是否存在显著差异？

这是一个典型的多重处理问题，其中：

- **处理变量**：种族 (race)，包含 5 个类别 (白人、黑人、西班牙裔、亚裔、其他)，白人作为基准组
- **结果变量**：24 个月时的标准化智商测试成绩 (std_iq_24)
- **控制变量**：儿童年龄 (age_24)、性别 (female) 等
- **分层变量**：社会经济地位五分位数 (SES_quintile)
- **样本权重**：调查权重 (W2C0)

### 4.2 基础模型估计

我们首先运行一个包含少量控制变量的基础模型：

```stata
use test/example_fryer_levitt.dta, clear

* 基础回归：控制年龄和性别
multe std_iq_24 i.age_24 female [w=W2C0], ///
    treat(race) stratum(SES_quintile)
```

命令输出分为两个部分。第一部分是标准的 PL 估计结果：

```
Partly Linear Model Estimates (full sample)     Number of obs = 8,806

-----------------------------------------------------------------------------
  std_iq_24 |      Coef.   Std. Err.      z    P>|z|   [95% Conf. Interval]
------------+----------------------------------------------------------------
       race |
      Black |  -.2574154   .0281244    -9.15   0.000   -.3125383  -.2022925
   Hispanic |  -.2931465    .025962   -11.29   0.000   -.3440311   -.242262
      Asian |   -.262108    .034262    -7.65   0.000   -.3292603  -.1949557
      Other |  -.1563373   .0369127    -4.24   0.000   -.2286848  -.0839898
-----------------------------------------------------------------------------
```

这些结果表明，在控制了年龄和性别后，黑人、西班牙裔、亚裔和其他族裔的儿童相对于白人儿童的智商成绩分别低 0.26、0.29、0.26 和 0.16 个标准差，且所有系数都在 1% 水平上显著。

第二部分是替代估计量的对比表格：

```
Alternative Estimates on Full Sample:

             |      PL      OWN      ATE       EW       CW
-------------+---------------------------------------------
       Black |  -.2574   -.2482   -.2655    -.255   -.2604
          SE |  .02812   .02906   .02983   .02888   .02925
    Hispanic |  -.2931   -.2829   -.2992   -.2862   -.2944
          SE |  .02596   .02673   .02988    .0268   .02792
       Asian |  -.2621   -.2609   -.2599   -.2611   -.2694
          SE |  .03426   .03432   .04177   .03433   .04751
       Other |  -.1563   -.1448   -.1503   -.1447   -.1522
          SE |  .03691   .03696   .03594   .03684   .03698
```

我们可以观察到：

1. 对于黑人和西班牙裔，OWN 估计量 (-.2482 和 -.2829) 都略小于 PL 估计量 (-.2574 和 -.2931)，暗示 PL 估计可能高估了种族差距
2. ATE、EW、CW 估计量与 PL 估计量都比较接近，但存在一定差异
3. 所有估计量的标准误都比较接近，说明不同方法的估计精度相当

### 4.3 倾向得分变异性检验

输出的最后部分是倾向得分变异性检验的结果：

```
P-values for null hypothesis of no propensity score variation:
Wald test:  2.1e-188
  LM test:  8.8e-197
```

这两个检验的 p 值都极小 (远小于 0.001)，强烈拒绝了「倾向得分不随协变量变化」的原假设。这意味着：

1. 种族与控制变量 (年龄、性别、社会经济地位) 之间存在显著的系统性关联
2. 污染偏差很可能存在，PL 估计量可能不是无偏的
3. 研究者应当谨慎解读 PL 结果，并考虑使用替代估计量

### 4.4 估计量差异的统计检验

为了量化污染偏差的大小，我们可以查看 OWN 估计量与 PL 估计量的差异：

```stata
multe, est(OWN) diff
```

输出结果：

```
Own Treatment Effects Estimates (full sample)   Number of obs = 8,806

-----------------------------------------------------------------------------
  std_iq_24 |      Coef.   Std. Err.      z    P>|z|   [95% Conf. Interval]
------------+----------------------------------------------------------------
       race |
      Black |  -.0394671   .0120418    -3.28   0.001   -.0630686  -.0158656
   Hispanic |  -.0126872   .0057131    -2.22   0.026   -.0238847  -.0014898
       Asian |    .009752   .0048651     2.00   0.045    .0002166   .0192874
       Other |  -.0242985   .0073833    -3.29   0.001   -.0387696  -.0098274
-----------------------------------------------------------------------------
```

这个表格展示的是 `PL - OWN` 的差异 (即污染偏差的估计值) 及其标准误。我们可以看到：

- 对于黑人，污染偏差为 -0.039 个标准差，在 1% 水平上显著
- 对于西班牙裔，污染偏差为 -0.013 个标准差，在 5% 水平上显著
- 对于亚裔，污染偏差为 0.010 个标准差，在 5% 水平上显著
- 对于其他族裔，污染偏差为 -0.024 个标准差，在 1% 水平上显著

这些结果表明，污染偏差在统计上是显著的，且其大小对于某些种族群体 (特别是黑人) 来说并不算小。如果我们只关注 PL 估计，就会略微高估黑人与白人之间的认知差距。

---

## 5. 扩展分析：控制变量的选择与重叠样本

### 5.1 增加控制变量的影响

在实证研究中，研究者通常会尝试加入更多的控制变量以减少遗漏变量偏差。然而，控制变量越多，倾向得分的变异可能也越大，污染偏差的问题可能会更严重。我们来看一个包含更多控制变量的例子：

```stata
local controls i.age_24 female i.siblings i.family_structure

multe std_iq_24 `controls' [w=W2C0], ///
    treat(race) stratum(SES_quintile)
```

运行后，`multe` 会首先给出一个警告：

```
The following variables have no within-treatment variation
and are dropped from the overlap sample:
    6.siblings
```

这个警告告诉我们，在某些处理组中，`siblings == 6` 这个类别没有观测值。具体来说，我们可以通过交叉表验证：

```stata
tab race if siblings == 6, mi
```

结果显示：

```
    race |      Freq.     Percent        Cum.
---------+-----------------------------------
   White |         18       40.00       40.00
   Black |         10       22.22       62.22
Hispanic |         12       26.67       88.89
   Asian |          5       11.11      100.00
---------+-----------------------------------
   Total |         45      100.00
```

我们可以看到，在有 6 个兄弟姐妹的观测中，没有「其他」族裔的儿童。这意味着，对于「其他」族裔，ATE 估计量是无法识别的，因为我们缺少必要的共同支撑 (common support)。

### 5.2 重叠样本的构建

为了解决这个问题，`multe` 会自动构建一个「重叠样本」(overlap sample)，该样本剔除了以下观测：

1. 所有导致共同支撑失败的分层 (strata)——即某些处理组完全缺失的分层
2. 所有导致共同支撑失败的控制变量类别——例如 `siblings == 6`

在重叠样本中，所有估计量都是可识别的。`multe` 会同时报告全样本和重叠样本的结果：

```
Alternative Estimates on Full Sample:

             |      PL      OWN      ATE       EW       CW
-------------+---------------------------------------------
       Black |  -.2438   -.2043   -.2482    -.218   -.2415
          SE |  .03077   .03321   .03553   .03276   .03853
    Hispanic |  -.2928   -.2801   -.2878    -.285   -.3001
          SE |   .0259   .02671      .03   .02671   .02984
       Asian |  -.2739   -.2836   -.2742   -.2839   -.2863
          SE |  .03418    .0343   .04195   .03426   .04549
       Other |   -.152   -.1277        .   -.1295   -.1452
          SE |  .03689   .03736        .   .03713   .03817

Alternative Estimates on Overlap Sample:

             |      PL      OWN      ATE       EW       CW
-------------+---------------------------------------------
       Black |  -.2458   -.2062   -.2503   -.2199   -.2436
          SE |  .03074   .03318   .03532    .0327   .03824
    Hispanic |  -.2932   -.2809    -.288   -.2858   -.2987
          SE |  .02595   .02676   .03001   .02678   .02987
       Asian |  -.2741   -.2839    -.274   -.2841   -.2884
          SE |  .03417   .03429   .04187   .03426   .04563
       Other |  -.1511    -.127   -.1392   -.1289   -.1459
          SE |  .03688   .03735   .03618   .03711   .03853
```

注意，在全样本中，「其他」族裔的 ATE 估计为空 (`.`)，但在重叠样本中，所有估计量都是可识别的。

### 5.3 污染偏差在重叠样本中的表现

我们可以进一步查看重叠样本中污染偏差的大小：

```stata
multe, est(OWN) diff overlap
```

输出结果：

```
Own Treatment Effects Estimates (overlap sample)

-----------------------------------------------------------------------------
  std_iq_24 |      Coef.   Std. Err.      z    P>|z|   [95% Conf. Interval]
------------+----------------------------------------------------------------
       race |
      Black |  -.0395843   .0120096    -3.30   0.001   -.0631227  -.0160458
   Hispanic |    -.01229   .0056924    -2.16   0.031   -.0234468  -.0011332
       Asian |    .009776   .0048602     2.01   0.044    .0002502   .0193019
       Other |  -.0240377   .0073857    -3.25   0.001   -.0385134   -.009562
-----------------------------------------------------------------------------
```

可以看到，在重叠样本中，污染偏差的大小和统计显著性与全样本非常接近，说明剔除少量观测对结果的影响很小。

---

## 6. 聚类标准误与 Oracle 标准误

### 6.1 聚类标准误

在许多实证研究中，观测值之间可能存在组内相关性。例如，在 Fryer and Levitt (2013) 的数据中，同一个访谈员 (interviewer) 收集的数据可能存在相关性。在这种情况下，我们应该使用聚类标准误来校正组内相关性带来的标准误低估问题。

`multe` 支持 `cluster()` 选项：

```stata
local controls i.age_24 female

multe std_iq_24 `controls' [w=W2C0], ///
    treat(race) stratum(SES_quintile) cluster(interviewer_ID_24)
```

输出结果：

```
Partly Linear Model Estimates (full sample)     Number of obs = 8,806

-----------------------------------------------------------------------------
             |               Cluster
  std_iq_24 |      Coef.   Std. Err.      z    P>|z|   [95% Conf. Interval]
------------+----------------------------------------------------------------
       race |
      Black |  -.2574154   .0411564    -6.25   0.000   -.3380804  -.1767504
   Hispanic |  -.2931465   .0440827    -6.65   0.000    -.379547  -.2067461
       Asian |   -.262108   .0521067    -5.03   0.000   -.3642353  -.1599807
       Other |  -.1563373   .0403717    -3.87   0.000   -.2354645  -.0772102
-----------------------------------------------------------------------------
```

可以看到，聚类标准误 (约 0.04-0.05) 明显大于稳健标准误 (约 0.025-0.035)，这反映了组内相关性的存在。倾向得分变异性检验的 p 值也发生了变化：

```
P-values for null hypothesis of no propensity score variation:
Wald test:  9.4e-133
  LM test:  6.79e-07
```

虽然 p 值有所增大，但仍然高度显著，说明即使考虑聚类相关性，倾向得分的变异性仍然是一个严重的问题。

### 6.2 Oracle 标准误

对于 ATE、EW、CW 这三种估计量，`multe` 提供了两种标准误：

1. **默认标准误**：考虑了倾向得分估计的不确定性
2. **Oracle 标准误**：假设倾向得分是已知的，不考虑其估计误差

Oracle 标准误通常小于默认标准误，因为它忽略了倾向得分估计带来的额外变异。我们可以通过 `oracle` 选项来计算 Oracle 标准误：

```stata
multe, est(ATE) oracle
```

输出结果：

```
ATE Estimates (full sample)                     Number of obs = 8,806

-----------------------------------------------------------------------------
             |               Oracle
  std_iq_24 |      Coef.   Std. Err.      z    P>|z|   [95% Conf. Interval]
------------+----------------------------------------------------------------
       race |
      Black |  -.2481627   .0354964    -6.99   0.000   -.3177343  -.1785911
   Hispanic |  -.2878414   .0299246    -9.62   0.000   -.3464926  -.2291902
       Asian |  -.2741527   .0418856    -6.55   0.000   -.3562469  -.1920584
       Other |          0  (omitted)
-----------------------------------------------------------------------------
```

注意，在这个例子中，由于「其他」族裔的 ATE 在全样本中无法识别 (缺少共同支撑)，Stata 将其视为省略变量。如果我们希望看到所有族裔的结果，应该使用重叠样本：

```stata
multe, est(ATE) oracle overlap
```

---

## 7. 实证建议与最佳实践

### 7.1 何时应该关注污染偏差？

基于 Goldsmith-Pinkham 等人的研究和 `multe` 命令的实践经验，我们建议在以下情况下特别关注污染偏差问题：

1. **处理变量包含多个类别**：例如种族、教育水平、职业类型、政策干预强度等
2. **控制变量与处理变量高度相关**：例如在研究教育回报时，家庭收入与教育水平密切相关
3. **样本选择存在明显的选择性**：例如在医疗研究中，健康状况较差的患者更可能接受某种治疗
4. **倾向得分变异性检验高度显著**：Wald 检验或 LM 检验的 p 值远小于 0.05

在这些情况下，标准的 OLS 估计可能会受到污染偏差的严重影响，研究者应当：

- 运行 `multe` 命令，检查倾向得分变异性检验的结果
- 比较 PL、OWN、ATE、EW、CW 等不同估计量，评估污染偏差的大小
- 如果污染偏差在统计上显著且实际意义重大，应当报告替代估计量的结果
- 在稳健性检验中，讨论不同估计量之间的差异及其可能的原因

### 7.2 如何选择合适的估计量？

`multe` 提供了五种估计量，每种都有其优缺点：

**PL (部分线性模型)**

- **优点**：计算简单，是标准的 OLS 估计
- **缺点**：在倾向得分存在变异时，可能受到污染偏差的严重影响
- **适用场景**：倾向得分变异性检验不显著时，或作为基准结果报告

**OWN (自身处理效应)**

- **优点**：剔除了污染偏差，解释清晰 (仅包含自身处理效应)
- **缺点**：需要估计污染偏差，在小样本中可能不够精确
- **适用场景**：倾向得分变异显著，且研究者关心「纯粹」的处理效应

**ATE (平均处理效应)**

- **优点**：估计的是未加权的平均因果效应，具有明确的因果解释
- **缺点**：需要估计更多参数 (控制变量与处理变量的交互项)，可能降低估计效率
- **适用场景**：研究者关心总体平均因果效应，且样本量足够大

**EW (最易估计加权)**

- **优点**：通过加权降低倾向得分极端值的影响，估计更稳定
- **缺点**：估计的是加权 ATE，权重依赖于样本分布
- **适用场景**：倾向得分存在极端值，或样本在某些处理组中分布不均

**CW (最易估计公共加权)**

- **优点**：使用公共权重函数，所有处理组共享相同的加权方案
- **缺点**：估计的是加权 ATE，权重依赖于样本分布
- **适用场景**：研究者希望在所有处理组之间保持一致的加权标准

在实践中，我们建议：

1. **始终报告 PL 估计作为基准**，并检查倾向得分变异性检验
2. **如果倾向得分变异显著**，同时报告 OWN 和 ATE (或 EW/CW) 的结果
3. **在稳健性检验中**，讨论不同估计量之间的差异及其实际意义
4. **如果不同估计量的结果相近**，说明污染偏差的影响可能较小，可以放心使用 PL 估计
5. **如果不同估计量的结果差异较大**，应当深入分析污染偏差的来源，并谨慎解读结果

### 7.3 处理重叠样本问题

当某些处理组在特定控制变量取值下完全缺失时，会出现共同支撑失败的问题。`multe` 会自动构建重叠样本来解决这个问题。研究者应当：

1. **关注 `multe` 的警告信息**，了解哪些变量或分层被剔除
2. **检查重叠样本与全样本的样本量差异**，评估样本损失的程度
3. **比较全样本与重叠样本的结果**，判断样本选择是否影响结论
4. **在正文或附录中报告重叠样本的结果**，增强结果的稳健性

如果重叠样本与全样本的差异很大，说明共同支撑失败是一个严重的问题，研究者可能需要：

- 减少控制变量的数量或合并某些类别
- 采用倾向得分修剪 (trimming) 或再加权方法
- 讨论外部效度的限制，承认结论仅适用于重叠样本

---

## 8. 小结

污染偏差是多重处理回归中一个长期被忽视但实际上非常重要的问题。当控制变量与处理变量的倾向得分存在关联时，标准的 OLS 估计会受到其他处理组的「污染」，导致我们无法准确识别感兴趣的因果效应。Goldsmith-Pinkham, Hull, and Kolesár (2024) 的工作为我们提供了一套系统的诊断和纠正工具，`multe` 命令则将这些方法实现为易于使用的 Stata 程序。

通过 Fryer and Levitt (2013) 的数据，我们展示了如何使用 `multe` 命令来：

1. 检测倾向得分的变异性 (Wald 检验和 LM 检验)
2. 比较不同估计量 (PL、OWN、ATE、EW、CW) 的结果
3. 量化污染偏差的大小及其统计显著性
4. 处理共同支撑失败问题 (重叠样本)
5. 计算聚类标准误和 Oracle 标准误

我们建议实证研究者在分析多重处理问题时，养成使用 `multe` 进行污染偏差诊断的习惯。即使污染偏差最终被证明是微不足道的，这个诊断过程也能够增强研究结果的可信度，并帮助研究者更好地理解数据的结构和估计的性质。

未来的研究可以进一步探索以下方向：

1. 在不同的应用场景 (政策评估、劳动经济学、公司财务等) 中评估污染偏差的普遍性和严重程度
2. 开发更多样化的加权方案和估计策略，以在不同的数据特征下优化估计效率
3. 将污染偏差的诊断与其他因果推断方法 (如 DID、RDD、IV 等) 相结合，形成更全面的稳健性检验框架

随着因果推断方法的不断发展，我们期待看到更多关于污染偏差的理论和应用研究，为实证研究提供更加可靠和精准的工具。

---

## 参考文献

1. Fryer, R. G., & Levitt, S. D. (2013). Testing for Racial Differences in the Mental Ability of Young Children. American Economic Review, 103(2), 981–1005. [Link](https://doi.org/10.1257/aer.103.2.981), [PDF](https://www.aeaweb.org/articles?id=10.1257/aer.103.2.981), [Google](<https://scholar.google.com/scholar?q=Testing for Racial Differences in the Mental Ability of Young Children>).

2. Goldsmith-Pinkham, P., Hull, P., & Kolesár, M. (2024). Contamination Bias in Linear Regressions (Version 3). arXiv. [Link](https://doi.org/10.48550/arXiv.2106.05024) (rep), [PDF](https://arxiv.org/pdf/2106.05024.pdf), [Google](<https://scholar.google.com/scholar?q=Contamination Bias in Linear Regressions>).
